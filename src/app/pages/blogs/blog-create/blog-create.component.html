<div class="min-h-screen bg-gray-50 flex flex-col pb-20">

  <!-- Top Bar -->
  <div class="flex-1 max-w-7xl w-full mx-auto p-8 grid grid-cols-1 lg:grid-cols-12 gap-8">

    <!-- Breadcrumb Navigation -->
    <div class="lg:col-span-12">
      <nav class="flex items-center text-sm font-medium text-gray-500 mb-2">
        <a routerLink="/blogs" class="hover:text-purple-600 transition-colors">Blogs</a>
        <i class="uil uil-angle-right mx-2 text-gray-400"></i>
        <span class="text-gray-900">Create Post</span>
      </nav>
    </div>

    <!-- Main Editor Area (Left 8 cols) -->
    <div class="lg:col-span-8 space-y-6">

      <!-- Editor Card -->
      <div class="bg-white rounded-xl p-8 card-shadow border border-gray-100 min-h-[600px] flex flex-col">
        <!-- Clean Title Input -->
        <input type="text" [(ngModel)]="postTitle" placeholder="Enter post title here..."
          class="text-4xl font-extrabold text-gray-900 placeholder-gray-300 border-none focus:ring-0 p-0 w-full mb-8 leading-tight outline-none bg-transparent track-tight">

        <!-- Quill Editor -->
        <quill-editor [(ngModel)]="postContent" [modules]="quillConfig"
          placeholder="Start writing your health insights..." class="clean-editor flex-1"></quill-editor>

        <!-- Action Buttons (Bottom of Editor) -->
        <div class="flex items-center justify-end space-x-3 pt-8 mt-auto border-t border-gray-50 ">
          <button (click)="saveDraft()"
            class="text-sm font-semibold text-gray-600 hover:text-gray-900 px-6 py-3 cursor-pointer rounded-lg hover:bg-gray-50 transition-all">
            Save Draft
          </button>
          <button (click)="onSubmit()"
            class="bg-purple-600 hover:bg-purple-700 text-white text-sm font-bold px-8 py-3 rounded-xl shadow-lg hover:shadow-purple-500/30 transform hover:-translate-y-0.5 transition-all flex items-center space-x-2 cursor-pointer">
            <i class="uil uil-message"></i>
            <span>Publish Post</span>
          </button>
        </div>
      </div>

      <!-- User Engagement Card -->
      <div class="bg-white rounded-xl p-6 card-shadow border border-gray-100">
        <div class="flex items-center space-x-2 mb-6">
          <i class="uil uil-comment-alt-message text-purple-600 text-xl"></i>
          <h3 class="text-lg font-bold text-gray-900">User Engagement</h3>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <!-- Allow Comments -->
          <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-100">
            <div class="space-y-1">
              <p class="font-semibold text-gray-800 text-sm">Allow Comments</p>
              <p class="text-xs text-gray-500">Enable users to leave comments on this post</p>
            </div>
            <label class="relative inline-flex items-center cursor-pointer">
              <input type="checkbox" [(ngModel)]="allowComments" class="sr-only peer">
              <div
                class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600">
              </div>
            </label>
          </div>

          <!-- Social Sharing (Mockup Placeholder) -->
          <div class="flex flex-col space-y-3">
            <span class="text-sm font-semibold text-gray-800">Enable Social Sharing</span>
            <div class="flex space-x-3">
              <button
                class="flex-1 py-2 px-3 bg-blue-50 text-blue-600 rounded-lg text-xs font-semibold hover:bg-blue-100 transition flex items-center justify-center space-x-1">
                <i class="uil uil-facebook-f"></i> <span>Facebook</span>
              </button>
              <button
                class="flex-1 py-2 px-3 bg-sky-50 text-sky-500 rounded-lg text-xs font-semibold hover:bg-sky-100 transition flex items-center justify-center space-x-1">
                <i class="uil uil-twitter"></i> <span>Twitter</span>
              </button>
              <button
                class="flex-1 py-2 px-3 bg-green-50 text-green-600 rounded-lg text-xs font-semibold hover:bg-green-100 transition flex items-center justify-center space-x-1">
                <i class="uil uil-whatsapp"></i> <span>WhatsApp</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Structured Content Card -->
      <div class="bg-white rounded-xl p-6 card-shadow border border-gray-100">
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center space-x-2">
            <i class="uil uil-list-ul text-purple-600 text-xl"></i>
            <h3 class="text-lg font-bold text-gray-900">Structured Content</h3>
          </div>
          <label class="flex items-center space-x-2 text-xs text-gray-500">
            <input type="checkbox" [(ngModel)]="regenerateStructured" class="rounded border-gray-300 text-purple-600">
            <span>Auto-generate from HTML on save</span>
          </label>
        </div>

        <div class="space-y-5">
          <div class="space-y-3">
            <div class="flex items-center justify-between">
              <p class="text-sm font-semibold text-gray-800">Sections</p>
              <button (click)="addSection()" class="text-xs text-purple-600 font-semibold hover:text-purple-800">
                + Add Section
              </button>
            </div>
            <div *ngFor="let section of sections; let i = index" class="bg-gray-50 border border-gray-100 rounded-lg p-4 space-y-3">
              <div class="flex items-center justify-between gap-3">
                <input [(ngModel)]="section.title" placeholder="Section title"
                  class="flex-1 bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-100 focus:border-purple-500">
                <div class="flex items-center gap-2">
                  <button (click)="moveSection(i, -1)" [disabled]="i === 0" class="text-gray-400 hover:text-purple-600 disabled:opacity-40">
                    <i class="uil uil-arrow-up"></i>
                  </button>
                  <button (click)="moveSection(i, 1)" [disabled]="i === sections.length - 1" class="text-gray-400 hover:text-purple-600 disabled:opacity-40">
                    <i class="uil uil-arrow-down"></i>
                  </button>
                  <button (click)="removeSection(i)" class="text-xs text-gray-400 hover:text-red-500">
                    Remove
                  </button>
                </div>
              </div>
              <textarea [(ngModel)]="section.body" rows="3" placeholder="Section body"
                class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-100 focus:border-purple-500 resize-none"></textarea>
            </div>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-800 mb-2">Quote</label>
            <textarea [(ngModel)]="quote" rows="2" placeholder="Optional featured quote"
              class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-100 focus:border-purple-500 resize-none"></textarea>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-800 mb-2">Read Time</label>
            <input [(ngModel)]="readTime" placeholder="e.g. 5 min read"
              class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-purple-100 focus:border-purple-500">
          </div>
        </div>
      </div>

    </div>

    <!-- Sidebar (Right 4 cols) -->
    <div class="lg:col-span-4 space-y-6">

      <div class="bg-white rounded-xl p-4 border border-gray-100 flex items-center space-x-3">
        <div class="w-12 h-12 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center font-bold">
          {{ authorAvatarLabel }}
        </div>
        <div>
          <p class="text-sm font-semibold text-gray-900">{{ authorName }}</p>
          <p class="text-xs text-gray-500">{{ authorRole }}</p>
        </div>
      </div>

      <!-- Featured Image (Moved Here) -->
      <div>
        <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Featured Image</h3>
        <div
          class="relative group w-full h-48 bg-white rounded-xl overflow-hidden border-2 border-dashed border-gray-200 hover:border-purple-400 hover:bg-purple-50/30 transition-all duration-300 cursor-pointer"
          (click)="fileInput.click()">
          <input type="file" #fileInput hidden (change)="onFileSelected($event)" accept="image/*">
          <img *ngIf="filePreview" [src]="filePreview"
            class="w-full h-full object-cover absolute inset-0 transition-transform duration-700 group-hover:scale-105">
          <div
            class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none transition-all duration-300"
            [ngClass]="{'opacity-0 group-hover:opacity-100 bg-white/60 backdrop-blur-sm': filePreview}">
            <div
              class="bg-white p-3 rounded-full shadow-md mb-2 group-hover:scale-110 transition-transform duration-300">
              <i class="uil uil-image-upload text-2xl text-purple-600"></i>
            </div>
            <span class="text-xs text-gray-600 font-bold">{{ filePreview ? 'Change Image' : 'Upload Image' }}</span>
          </div>
        </div>
      </div>

      <!-- Gallery Images -->
      <div>
        <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Gallery Images</h3>
        <div class="bg-white rounded-xl border border-gray-100 p-4">
          <input type="file" hidden #galleryInput multiple accept="image/*" (change)="onGallerySelected($event)">
          <button (click)="galleryInput.click()" class="w-full py-2 text-sm font-semibold text-purple-600 bg-purple-50 rounded-lg hover:bg-purple-100 transition">
            Upload Gallery Images
          </button>
          <div *ngIf="galleryPreviews.length > 0" class="grid grid-cols-3 gap-2 mt-3">
            <div *ngFor="let preview of galleryPreviews; let i = index" class="relative h-20 rounded-lg overflow-hidden border border-gray-200">
              <img [src]="preview" class="w-full h-full object-cover">
              <button (click)="removeGalleryFile(i)" class="absolute top-1 right-1 bg-white/80 text-red-600 rounded-full w-5 h-5 flex items-center justify-center">
                <i class="uil uil-times text-xs"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Post Settings Card -->
      <div class="space-y-6">

        <!-- Category -->
        <div>
          <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Category</h3>
          <div class="relative group">
            <select [(ngModel)]="selectedCategory"
              class="w-full bg-white border border-gray-200 rounded-lg text-sm text-gray-700 focus:ring-2 focus:ring-purple-100 focus:border-purple-500 py-3 px-4 appearance-none transition-all cursor-pointer hover:border-gray-300 shadow-sm">
              <option value="" disabled>Select a category</option>
              <option *ngFor="let cat of categories" [value]="cat._id">{{cat.name}}</option>
            </select>
            <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-gray-400">
              <i class="uil uil-angle-down text-lg"></i>
            </div>
          </div>
        </div>

        <!-- Tags -->
        <div>
          <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Tags</h3>
          <div
            class="bg-white p-1 rounded-lg border border-gray-200 shadow-sm group focus-within:ring-2 focus-within:ring-purple-100 focus-within:border-purple-500 transition-all">
            <div class="flex flex-wrap gap-2 p-2" *ngIf="tags.length > 0">
              <span *ngFor="let tag of tags"
                class="inline-flex items-center px-2.5 py-1 bg-purple-50 text-purple-700 text-xs font-medium rounded-full border border-purple-100">
                {{tag}}
                <button (click)="removeTag(tag)"
                  class="ml-1.5 text-purple-400 hover:text-purple-900 focus:outline-none transition-colors">
                  <i class="uil uil-times"></i>
                </button>
              </span>
            </div>
            <div class="relative">
              <input type="text" [(ngModel)]="newTag" (keydown.enter)="addTag()" placeholder="Add tags..."
                class="w-full bg-transparent border-none text-sm text-gray-700 focus:ring-0 py-2.5 px-3">
              <button (click)="addTag()"
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-purple-600 p-1 rounded-full hover:bg-gray-100 transition-colors">
                <i class="uil uil-plus-circle text-lg"></i>
              </button>
            </div>
          </div>
          <!-- Mock Tags Suggestion -->
          <div class="flex gap-2 mt-3">
            <span
              class="px-2 py-1 bg-purple-50 text-purple-600 text-[10px] font-semibold rounded-md cursor-pointer hover:bg-purple-100 transition"
              (click)="newTag='Wellness'; addTag()">Wellness <i class="uil uil-plus ml-1"></i></span>
            <span
              class="px-2 py-1 bg-pink-50 text-pink-600 text-[10px] font-semibold rounded-md cursor-pointer hover:bg-pink-100 transition"
              (click)="newTag='Lifestyle'; addTag()">Lifestyle <i class="uil uil-plus ml-1"></i></span>
          </div>
        </div>

        <!-- Topics -->
        <div>
          <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Topics</h3>
          <div class="bg-white p-1 rounded-lg border border-gray-200 shadow-sm group focus-within:ring-2 focus-within:ring-purple-100 focus-within:border-purple-500 transition-all">
            <div class="flex flex-wrap gap-2 p-2" *ngIf="topics.length > 0">
              <span *ngFor="let topic of topics"
                class="inline-flex items-center px-2.5 py-1 bg-violet-50 text-violet-700 text-xs font-medium rounded-full border border-violet-100">
                {{topic}}
                <button (click)="removeTopic(topic)"
                  class="ml-1.5 text-violet-400 hover:text-violet-900 focus:outline-none transition-colors">
                  <i class="uil uil-times"></i>
                </button>
              </span>
            </div>
            <div class="relative">
              <input type="text" [(ngModel)]="newTopic" (keydown.enter)="addTopic()" placeholder="Add topics (e.g. #Wellness)"
                class="w-full bg-transparent border-none text-sm text-gray-700 focus:ring-0 py-2.5 px-3">
              <button (click)="addTopic()"
                class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-purple-600 p-1 rounded-full hover:bg-gray-100 transition-colors">
                <i class="uil uil-plus-circle text-lg"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Featured -->
        <div>
          <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-3 ml-1">Featured</h3>
          <div class="flex items-center justify-between bg-white border border-gray-200 rounded-lg px-3 py-2 mb-3">
            <span class="text-sm text-gray-600">Show as featured</span>
            <label class="relative inline-flex items-center cursor-pointer">
              <input type="checkbox" [(ngModel)]="isFeatured" class="sr-only peer">
              <div class="w-10 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-purple-600"></div>
            </label>
          </div>
          <input [(ngModel)]="featuredLabel" placeholder="Featured label (e.g. Editors Pick)"
            class="w-full bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm text-gray-700 focus:ring-2 focus:ring-purple-100 focus:border-purple-500">
        </div>

        <!-- SEO Preview (Mockup) -->
        <div>
          <div class="flex justify-between items-center mb-3 ml-1">
            <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wider">SEO Preview</h3>
            <button class="text-[10px] text-purple-600 font-bold hover:underline">Edit SEO</button>
          </div>
          <div class="bg-gray-50 rounded-lg p-4 border border-gray-100 shadow-sm">
            <p class="text-sm text-blue-600 font-medium truncate mb-0.5">{{ postTitle || 'Post Title | HealthPulse Blog'
              }}</p>
            <p class="text-[10px] text-green-600 mb-2 truncate">healthpulse.com/blog/{{ (postTitle ||
              'how-to-improve').toLowerCase().replace(' ', '-') }}</p>
            <p class="text-[11px] text-gray-500 line-clamp-3">
              {{ excerpt || "This is a meta description preview. It should contain keywords to help users find your
              content on search engines." }}
            </p>
          </div>
        </div>

      </div>

    </div>
  </div>
</div>